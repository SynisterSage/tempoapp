# Environment Variables Configuration

## Overview
This document describes all environment variables required for Tempo development, staging, and production environments.

### Important Security Notes
- **Never commit `.env` files to Git** — Always use `.env.example` as template
- Store production secrets in: AWS Secrets Manager, GitHub Secrets, or Vercel Environment Variables
- Rotate secrets quarterly and immediately if compromised
- Different secrets per environment (dev/staging/prod)

---

## Backend Environment Variables

### `backend/.env.example`

```bash
# ============================================
# ENVIRONMENT & CORE CONFIG
# ============================================
NODE_ENV=development
PORT=3000
API_BASE_URL=http://localhost:3000
FRONTEND_URL=http://localhost:8081

# ============================================
# DATABASE (Supabase PostgreSQL)
# ============================================
# Supabase provides these via project settings
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here
DATABASE_URL=postgresql://postgres:password@db.your-project.supabase.co:5432/postgres

# Optional: Local PostgreSQL dev database
# DATABASE_URL=postgresql://postgres:password@localhost:5432/tempo_dev

# ============================================
# AUTHENTICATION (Supabase JWT & OAuth)
# ============================================
JWT_SECRET=your-super-secret-jwt-key-min-32-chars-long
JWT_EXPIRY=1h
REFRESH_TOKEN_EXPIRY=7d

# Google OAuth (for signup/login)
# Get from: https://console.cloud.google.com/
GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-client-secret
GOOGLE_OAUTH_REDIRECT_URI=http://localhost:3000/auth/google/callback

# Apple Sign-In (Phase 2+)
APPLE_CLIENT_ID=your-apple-client-id
APPLE_TEAM_ID=your-apple-team-id
APPLE_KEY_ID=your-apple-key-id

# ============================================
# THIRD-PARTY APIS
# ============================================

# Weather API (Free tier)
# Get from: https://openweathermap.org/api
WEATHER_API_PROVIDER=openweathermap
WEATHER_API_KEY=your-openweather-api-key
WEATHER_API_BASE_URL=https://api.openweathermap.org/data/2.5

# Golf Course API
# Get key from: https://www.golfcourseapi.com/
GOLF_COURSE_API_KEY=UD6VS23ZHZYXDNGITWYDLJ5KXU
GOLF_COURSE_API_BASE_URL=https://api.golfcourseapi.com

# Mapbox (Phase 1+, for custom map styling)
# Get from: https://account.mapbox.com/
MAPBOX_PUBLIC_TOKEN=your-mapbox-public-token
MAPBOX_SECRET_TOKEN=your-mapbox-secret-token

# ============================================
# PAYMENT PROCESSING (Phase 1+)
# ============================================
# For MVP: Use mock/fake payment flows
STRIPE_API_KEY=pk_live_your-public-key-or-sk_live-secret-for-backend
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret
STRIPE_PRICE_ID_PREMIUM_MONTHLY=price_1234567890

# ============================================
# ANALYTICS & MONITORING
# ============================================

# PostHog (Analytics - Free tier)
# Get from: https://posthog.com/
POSTHOG_API_KEY=your-posthog-api-key
POSTHOG_API_HOST=https://us.posthog.com

# Sentry (Error Tracking)
# Get from: https://sentry.io/
SENTRY_DSN=https://your-key@sentry.io/your-project-id
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================
# AI/ML MODELS
# ============================================

# Ollama (Self-hosted ML, local)
# Run locally: ollama pull llama2 (or other model)
OLLAMA_API_URL=http://localhost:11434
OLLAMA_MODEL=llama2

# Alternative: Hugging Face Inference API (Free tier available)
# Get from: https://huggingface.co/
HUGGINGFACE_API_KEY=your-hf-api-key
HUGGINGFACE_MODEL_ENDPOINT=https://api-inference.huggingface.co/models/[model-name]

# ============================================
# EMAIL SERVICE (Future: notifications)
# ============================================
SENDGRID_API_KEY=your-sendgrid-api-key
SENDGRID_FROM_EMAIL=noreply@tempo-golf.com

# ============================================
# LOGGING & DEBUGGING
# ============================================
LOG_LEVEL=debug
LOG_FORMAT=json
DEBUG=tempo:*

# ============================================
# RATE LIMITING & SECURITY
# ============================================
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_AUTH_MAX_REQUESTS=5

# CORS Configuration
CORS_ORIGINS=http://localhost:8081,http://localhost:3000,https://app.tempo-golf.com
CORS_CREDENTIALS=true

# ============================================
# FEATURE FLAGS
# ============================================
FEATURE_AR_ENABLED=true
FEATURE_PRACTICE_DRILLS_ENABLED=false
FEATURE_MULTIPLAYER_ENABLED=false
FEATURE_PREMIUM_ENABLED=false

```

---

## Frontend Environment Variables

### `frontend/.env.example`

```bash
# ============================================
# ENVIRONMENT & CORE CONFIG
# ============================================
REACT_APP_ENV=development
REACT_APP_API_BASE_URL=http://localhost:3000
REACT_APP_APP_VERSION=0.1.0

# ============================================
# SUPABASE (Auth & Database)
# ============================================
REACT_APP_SUPABASE_URL=https://your-project.supabase.co
REACT_APP_SUPABASE_ANON_KEY=your-anon-key

# ============================================
# OAUTH PROVIDERS
# ============================================

# Google OAuth
REACT_APP_GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
REACT_APP_GOOGLE_REDIRECT_URI=http://localhost:8081

# Apple Sign-In (iOS only, Phase 2+)
REACT_APP_APPLE_CLIENT_ID=your-apple-client-id
REACT_APP_APPLE_TEAM_ID=your-apple-team-id

# ============================================
# MAPS & LOCATION
# ============================================

# Google Maps API
REACT_APP_GOOGLE_MAPS_API_KEY=your-google-maps-api-key

# Mapbox (Phase 1+)
REACT_APP_MAPBOX_PUBLIC_TOKEN=your-mapbox-public-token

# ============================================
# THIRD-PARTY APIS
# ============================================

# Golf Course API
REACT_APP_GOLF_COURSE_API_KEY=UD6VS23ZHZYXDNGITWYDLJ5KXU

# Weather API
REACT_APP_WEATHER_API_PROVIDER=openweathermap

# ============================================
# ANALYTICS & MONITORING
# ============================================

# PostHog Analytics
REACT_APP_POSTHOG_API_KEY=your-posthog-api-key
REACT_APP_POSTHOG_API_HOST=https://us.posthog.com

# Sentry Error Tracking
REACT_APP_SENTRY_DSN=https://your-key@sentry.io/your-project-id
REACT_APP_SENTRY_ENVIRONMENT=development

# ============================================
# FEATURE FLAGS
# ============================================
REACT_APP_FEATURE_AR_ENABLED=true
REACT_APP_FEATURE_PRACTICE_DRILLS_ENABLED=false
REACT_APP_FEATURE_MULTIPLAYER_ENABLED=false
REACT_APP_FEATURE_PREMIUM_ENABLED=false

# ============================================
# DEBUG & LOGGING
# ============================================
REACT_APP_DEBUG=true
REACT_APP_LOG_LEVEL=debug

```

---

## API Keys & Service Setup

### Step-by-Step Setup Guide

#### 1. **Supabase** (Database + Auth)
```bash
1. Go to https://supabase.com/
2. Create new project
3. Copy URL and Keys from: Settings → API
4. Copy SUPABASE_URL and SUPABASE_ANON_KEY to frontend/.env
5. Copy SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY to backend/.env
```

#### 2. **Google OAuth**
```bash
1. Go to https://console.cloud.google.com/
2. Create OAuth 2.0 Credentials (Web application)
3. Add Authorized redirect URIs:
   - http://localhost:3000/auth/google/callback
   - http://localhost:8081/auth/google/callback (React Native)
4. Copy Client ID and Secret to .env files
```

#### 3. **Google Maps API**
```bash
1. Go to https://console.cloud.google.com/
2. Enable: Maps SDK for Android, Maps SDK for iOS, Distance Matrix API
3. Create API Key
4. Add restrictions: iOS app bundle ID or Android package name
5. Copy to REACT_APP_GOOGLE_MAPS_API_KEY
```

#### 4. **Golf Course API**
```bash
1. Your API Key: UD6VS23ZHZYXDNGITWYDLJ5KXU
2. Base URL: https://api.golfcourseapi.com
3. Documentation: https://api.golfcourseapi.com/docs/api/
4. Key endpoints:
   - GET /courses/search?q={query} — Search courses
   - GET /courses/{id} — Get course details
   - GET /courses/{id}/holes — Get hole layout
   - No authentication needed (key in params)
```

#### 5. **OpenWeather API** (Free Tier)
```bash
1. Go to https://openweathermap.org/api
2. Choose "Current Weather Data" (free)
3. Create account and get API key
4. Free tier: 60 calls/minute, 1,000,000 calls/month
5. Usage: GET /data/2.5/weather?lat={lat}&lon={lon}&appid={key}
```

#### 6. **PostHog Analytics** (Free Tier)
```bash
1. Go to https://posthog.com/
2. Create account and project
3. Copy API key
4. Free tier: Unlimited events, 1 year retention
5. Self-hosted option available
```

#### 7. **Sentry Error Tracking** (Free Tier)
```bash
1. Go to https://sentry.io/
2. Create account and project
3. Copy DSN
4. Free tier: 5,000 errors/month
5. Alerts for critical errors
```

#### 8. **Ollama** (Local ML Model, Free)
```bash
1. Install: https://ollama.ai/
2. Run: ollama serve
3. Pull model: ollama pull llama2
4. Accessible at: http://localhost:11434
5. Use for: Drill recommendations (locally, no API cost)
```

#### 9. **Mapbox** (Phase 1+)
```bash
1. Go to https://account.mapbox.com/
2. Create account
3. Generate tokens:
   - Public token (frontend, read-only)
   - Secret token (backend, full access)
4. Free tier: 50,000 map loads/month
```

---

## Environment by Deployment Stage

### Development (`NODE_ENV=development`)
```bash
# Use local/staging services
DATABASE_URL=postgresql://postgres@localhost:5432/tempo_dev
SUPABASE_URL=[staging-project]
PAYMENT_MODE=mock
LOG_LEVEL=debug
```

### Staging (`NODE_ENV=staging`)
```bash
# Use staging versions of services
DATABASE_URL=[staging-db]
SUPABASE_URL=[staging-project]
PAYMENT_MODE=test
LOG_LEVEL=info
```

### Production (`NODE_ENV=production`)
```bash
# Use production services with security
DATABASE_URL=[prod-db]
SUPABASE_URL=[prod-project]
PAYMENT_MODE=live
LOG_LEVEL=warn
```

---

## Security Best Practices

### ✅ DO
- Store secrets in environment variables (never hardcode)
- Use `.env.example` as template, commit to repo
- Rotate API keys quarterly
- Use different keys per environment
- Never log sensitive data (tokens, passwords, API keys)
- Keep `.env` in `.gitignore`

### ❌ DON'T
- Commit `.env` files to Git
- Share API keys via email or chat
- Use production keys in development
- Expose backend-only keys to frontend
- Log request/response bodies with secrets

---

## Local Development Setup

### Quick Start
```bash
# 1. Copy example files
cp backend/.env.example backend/.env
cp frontend/.env.example frontend/.env

# 2. Add your API keys to .env files
# (Open in editor and fill in real values)

# 3. Start services
cd backend && npm run dev
# In another terminal:
cd frontend && npm start

# 4. Access locally:
# Backend: http://localhost:3000
# Frontend (iOS): npx react-native run-ios
# Frontend (Android): npx react-native run-android
```

---

## Verification Checklist

Before starting development, verify:

- [ ] All required API keys obtained
- [ ] `.env` files created from `.env.example`
- [ ] All keys populated (at least placeholders)
- [ ] Backend starts without env errors: `npm run dev`
- [ ] Frontend builds without env errors: `npm start`
- [ ] Supabase connection working: `curl $SUPABASE_URL/rest/v1`
- [ ] Google Maps API working in app
- [ ] Weather API working: `curl "https://api.openweathermap.org/data/2.5/weather?lat=36.5622&lon=-121.9489&appid=$WEATHER_API_KEY"`
- [ ] Golf Course API working: `curl "https://api.golfcourseapi.com/courses/search?q=pebble&key=$GOLF_COURSE_API_KEY"`

---

**Last Updated**: December 6, 2025  
**Version**: MVP-ENV-CONFIG-1.0
